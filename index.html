<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Calculadora de Muestra - Dr. Jaime Zambrana Chac√≥n</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #eef2f3; margin: 0; padding: 20px; }
    .container { background: white; max-width: 700px; margin: auto; padding: 30px; border-radius: 10px; box-shadow: 0 0 12px rgba(0,0,0,0.15); }
    h1, h2 { text-align: center; color: #2e5d9f; }
    label { display: block; margin-top: 15px; font-weight: bold; }
    select, input { width: 100%; padding: 8px; margin-top: 5px; border-radius: 4px; border: 1px solid #ccc; }
    button { margin-top: 20px; width: 100%; padding: 10px; background-color: #2e5d9f; color: white; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; }
    button:hover { background-color: #1e406e; }
    #formulaInfo, #resultado { margin-top: 20px; background: #f9f9f9; padding: 15px; border-radius: 8px; border: 1px solid #ddd; }
    code { background: #eef; padding: 2px 4px; border-radius: 4px; font-weight: bold; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Calculadora de Tama√±o de Muestra</h1>
    <h2>Dr. Jaime Zambrana Chac√≥n</h2>

    <label>Tipo de poblaci√≥n:</label>
    <select id="tipoPoblacion" onchange="mostrarFormula()">
      <option value="finita">Finita (valor recomendado)</option>
      <option value="infinita">Infinita</option>
    </select>

    <div id="formulaInfo"></div>

    <label>Poblaci√≥n total (N, solo para finita):</label>
    <input type="number" id="population" placeholder="Ej. 1500">

    <label>Confianza (Z):</label>
    <select id="zValue">
      <option value="1.645">Z = 1.645 (90%)</option>
      <option value="1.96" selected>Z = 1.96 (95%)</option>
      <option value="2.576">Z = 2.576 (99%)</option>
    </select>

    <label>Proporci√≥n esperada (p):</label>
    <select id="pValue">
      <option value="0.5" selected>p = 0.50 (50%)</option>
      <option value="0.8">p = 0.80 (80%)</option>
      <option value="0.2">p = 0.20 (20%)</option>
      <option value="0.1">p = 0.10 (10%)</option>
      <option value="0.9">p = 0.90 (90%)</option>
    </select>

    <label>Margen de error (E) en %:</label>
    <select id="ePercent">
      <option value="0">0</option>
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5" selected>5</option>
      <option value="6">6</option>
      <option value="7">7</option>
      <option value="8">8</option>
      <option value="9">9</option>
      <option value="10">10</option>
    </select>

    <button onclick="calcularMuestra()">Calcular muestra</button>

    <div id="resultado"></div>
  </div>

  <script>
    function mostrarFormula() {
      const tipo = document.getElementById("tipoPoblacion").value;
      const formulaDiv = document.getElementById("formulaInfo");

      if (tipo === "finita") {
        formulaDiv.innerHTML = `
          <strong>üìò F√≥rmula para poblaci√≥n finita:</strong><br>
          <code>n = n‚ÇÄ / (1 + ((n‚ÇÄ - 1)/N))</code><br>
          <p><em>Descripci√≥n:</em> Se ajusta la muestra b√°sica n‚ÇÄ para reflejar el efecto de una poblaci√≥n limitada (N conocida). Esto evita sobreestimar el tama√±o necesario.</p>
        `;
      } else {
        formulaDiv.innerHTML = `
          <strong>üìò F√≥rmula para poblaci√≥n infinita:</strong><br>
          <code>n‚ÇÄ = (Z¬≤ √ó p √ó q) / E¬≤</code><br>
          <p><em>Descripci√≥n:</em> Se estima la muestra sin considerar un l√≠mite poblacional. Esta f√≥rmula es ideal cuando N es desconocida o tan grande que no afecta el c√°lculo.</p>
        `;
      }
    }

    function calcularMuestra() {
      const tipo = document.getElementById("tipoPoblacion").value;
      const N = parseFloat(document.getElementById("population").value);
      const Z = parseFloat(document.getElementById("zValue").value);
      const p = parseFloat(document.getElementById("pValue").value);
      const Epercent = parseFloat(document.getElementById("ePercent").value);
      const E = Epercent / 100;
      const q = 1 - p;

      const resultado = document.getElementById("resultado");

      if (E === 0) {
        resultado.innerHTML = "<span style='color:red;'>‚ö†Ô∏è El margen de error no puede ser 0%. Seleccione al menos 1%.</span>";
        return;
      }

      const n0 = (Math.pow(Z, 2) * p * q) / Math.pow(E, 2);

      if (tipo === "finita") {
        if (isNaN(N) || N <= 0) {
          resultado.innerHTML = "<span style='color:red;'>‚ö†Ô∏è Debe ingresar N para calcular poblaci√≥n finita.</span>";
          return;
        }
        const n = n0 / (1 + ((n0 - 1) / N));
        resultado.innerHTML = `
          <strong>üìå C√°lculo aplicado:</strong><br>
          <code>n = ${n0.toFixed(2)} / (1 + ((${n0.toFixed(2)} - 1)/${N}))</code><br>
          <strong>‚úÖ Resultado:</strong> <span style="color:green; font-size:1.2em;"><b>${Math.ceil(n)}</b> personas</span>
        `;
      } else {
        resultado.innerHTML = `
          <strong>üìå C√°lculo aplicado:</strong><br>
          <code>n‚ÇÄ = (${Z}¬≤ √ó ${p} √ó ${q.toFixed(2)}) / ${E}¬≤ = ${n0.toFixed(2)}</code><br>
          <strong>‚úÖ Resultado:</strong> <span style="color:green; font-size:1.2em;"><b>${Math.ceil(n0)}</b> personas</span>
        `;
      }
    }

    mostrarFormula(); // inicializa la f√≥rmula visible
  </script>
</body>
</html>
