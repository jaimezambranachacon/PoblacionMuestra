<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Calculadora de Muestra - By Phd DrZam</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body { background-color: #eef2f3; }
    .card { margin-top: 30px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    .btn-primary { background-color: #2e5d9f; border: none; }
    .btn-primary:hover { background-color: #1e406e; }
    code { background: #eef; padding: 4px 8px; border-radius: 5px; display: inline-block; }
  </style>
</head>
<body>
  <div class="container py-4">
    <div class="card p-4">
      <h2 class="text-center text-primary">Calculadora de Tama√±o de Muestra</h2>
      <h5 class="text-center text-secondary mb-4">Dr. Jaime Zambrana Chac√≥n</h5>

      <div class="mb-3">
        <label class="form-label">Tipo de poblaci√≥n:</label>
        <select class="form-select" id="tipoPoblacion" onchange="mostrarFormula()">
          <option value="finita">Finita (valor recomendado)</option>
          <option value="infinita">Infinita</option>
        </select>
      </div>

      <div id="formulaInfo" class="alert alert-info"></div>

      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label">Poblaci√≥n total (N):</label>
          <input type="number" class="form-control" id="population" placeholder="Ej. 1500">
        </div>
        <div class="col-md-6 mb-3">
          <label class="form-label">Confianza (Z):</label>
          <select class="form-select" id="zValue">
            <option value="1.645">90% (Z = 1.645)</option>
            <option value="1.96" selected>95% (Z = 1.96)</option>
            <option value="2.576">99% (Z = 2.576)</option>
          </select>
        </div>
        <div class="col-md-6 mb-3">
          <label class="form-label">Proporci√≥n esperada (p):</label>
          <select class="form-select" id="pValue">
            <option value="0.5" selected>0.50</option>
            <option value="0.8">0.80</option>
            <option value="0.2">0.20</option>
            <option value="0.1">0.10</option>
            <option value="0.9">0.90</option>
          </select>
        </div>
        <div class="col-md-6 mb-3">
          <label class="form-label">Margen de error (E) en %:</label>
          <select class="form-select" id="ePercent">
            ${[...Array(11).keys()].map(v => `<option value="${v}" ${v === 5 ? 'selected' : ''}>${v}%</option>`).join('')}
          </select>
        </div>
      </div>

      <div class="d-grid mt-3">
        <button class="btn btn-primary" onclick="calcularMuestra()">Calcular muestra</button>
      </div>

      <div id="resultado" class="alert alert-success mt-4"></div>
    </div>
  </div>

  <script>
    function mostrarFormula() {
      const tipo = document.getElementById("tipoPoblacion").value;
      const formulaDiv = document.getElementById("formulaInfo");

      if (tipo === "finita") {
        formulaDiv.innerHTML = `\\(n = \\frac{n_0}{1 + \\frac{n_0 - 1}{N}}\\)<br><small>‚öôÔ∏è Ajuste para poblaciones finitas</small>`;
        MathJax.typesetPromise();
      } else {
        formulaDiv.innerHTML = `\\(n_0 = \\frac{Z^2 \\cdot p \\cdot q}{E^2}\\)<br><small>üåç Aproximaci√≥n para poblaciones infinitas</small>`;
        MathJax.typesetPromise();
      }
    }

    function calcularMuestra() {
      const tipo = document.getElementById("tipoPoblacion").value;
      const N = parseFloat(document.getElementById("population").value);
      const Z = parseFloat(document.getElementById("zValue").value);
      const p = parseFloat(document.getElementById("pValue").value);
      const Epercent = parseFloat(document.getElementById("ePercent").value);
      const E = Epercent / 100;
      const q = 1 - p;

      const resultado = document.getElementById("resultado");

      if (E === 0) {
        resultado.innerHTML = "<strong>‚ö†Ô∏è Margen de error no puede ser 0%</strong>";
        return;
      }

      const n0 = (Math.pow(Z, 2) * p * q) / Math.pow(E, 2);

      if (tipo === "finita") {
        if (isNaN(N) || N <= 0) {
          resultado.innerHTML = "<strong>‚ö†Ô∏è Ingrese N correctamente</strong>";
          return;
        }
        const n = n0 / (1 + ((n0 - 1) / N));
        resultado.innerHTML = `\\(n = \\frac{${n0.toFixed(2)}}{1 + \\frac{${n0.toFixed(2)} - 1}{${N}}}\\)<br><strong>‚úÖ Tama√±o m√≠nimo:</strong> ${Math.ceil(n)} personas`;
      } else {
        resultado.innerHTML = `\\(n_0 = \\frac{${Z}^2 \\cdot ${p} \\cdot ${q.toFixed(2)}}{${E}^2} = ${n0.toFixed(2)}\\)<br><strong>‚úÖ Tama√±o m√≠nimo:</strong> ${Math.ceil(n0)} personas`;
      }

      MathJax.typesetPromise();
    }

    mostrarFormula(); // inicializa la f√≥rmula visible
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
